webpackJsonp([4],{"1x0O":function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e={data:function(){return{products:[],product:{},status:{loadingItem:""},productQty:0,cart:{},isLoading:!1,coupon_code:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getProducts:function(){var t=this;t.isLoading=!0,this.$http.get("https://vue-course-api.hexschool.io/api/emily/products/all").then(function(s){console.log("getProducts",s.data),t.products=s.data.products,t.isLoading=!1})},getProduct:function(t){var s=this,a="https://vue-course-api.hexschool.io/api/emily/product/"+t;s.status.loadingItem=t,this.$http.get(a).then(function(t){console.log("getProduct",t.data),s.product=t.data.product,$("#productModal").modal("show"),s.status.loadingItem=""})},addtoCart:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this;a.status.loadingItem=t;var e={product_id:t,qty:s};this.$http.post("https://vue-course-api.hexschool.io/api/emily/cart",{data:e}).then(function(t){console.log(t.data),a.status.loadingItem="",a.getCart(),$("#productModal").modal("hide")})},getCart:function(){var t=this;t.isLoading=!0,this.$http.get("https://vue-course-api.hexschool.io/api/emily/cart").then(function(s){console.log("getCart: ",s.data),t.cart=s.data.data,t.isLoading=!1})},delCart:function(t){var s=this,a=this,e="https://vue-course-api.hexschool.io/api/emily/cart/"+t;a.isLoading=!0,this.$http.delete(e).then(function(t){s.$bus.$emit("message:push",t.data.message,"danger"),a.getCart(),a.isLoading=!1})},addCouponCode:function(){var t=this,s={code:t.coupon_code};t.isLoading=!0,this.$http.post("https://vue-course-api.hexschool.io/api/emily/coupon",{data:s}).then(function(s){console.log("coupon: ",s.data),t.getCart(),t.isLoading=!1})},createOrder:function(){var t=this,s=t.form;this.$http.post("https://vue-course-api.hexschool.io/api/emily/order",{data:s}).then(function(s){console.log("訂單已建立: ",s.data),s.data.success&&t.$router.push("/back_order_checkout/"+s.data.orderId),t.isLoading=!1})}},created:function(){this.getProducts(),this.getCart()}},o={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("section",{staticClass:"my-6 text-topic"},[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(s){t.isLoading=s}}}),t._v(" "),a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"row mt-9"},t._l(t.products,function(s){return a("div",{key:s.id,staticClass:"col-md-4 mb-4"},[a("div",{staticClass:"card border-0 shadow-sm"},[a("div",{staticStyle:{height:"200px","background-size":"cover","background-position":"center"},style:{backgroundImage:"url("+s.imageUrl+")"}}),t._v(" "),a("div",{staticClass:"card-body",staticStyle:{height:"136px"}},[a("span",{staticClass:"badge badge-secondary float-right ml-2"},[t._v(t._s(s.category))]),t._v(" "),a("h5",{staticClass:"card-title"},[a("a",{staticClass:"text-dark",attrs:{href:"#"}},[t._v(t._s(s.title))])]),t._v(" "),a("p",{staticClass:"card-text"},[t._v(t._s(s.content))]),t._v(" "),a("div",{staticClass:"d-flex justify-content-between align-items-baseline"},[s.price?t._e():a("div",{staticClass:"h5"},[t._v(t._s(s.origin_price)+" 元")]),t._v(" "),s.price?a("del",{staticClass:"h6"},[t._v("原價 "+t._s(s.origin_price)+" 元")]):t._e(),t._v(" "),s.price?a("div",{staticClass:"h5"},[t._v("特價 "+t._s(s.price)+" 元")]):t._e()])]),t._v(" "),a("div",{staticClass:"card-footer d-flex"},[a("button",{staticClass:"btn btn-outline-secondary btn-sm",attrs:{type:"button"},on:{click:function(a){return t.getProduct(s.id)}}},[t.status.loadingItem===s.id?a("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("\r\n                      查看更多\r\n                    ")]),t._v(" "),a("button",{staticClass:"btn btn-outline-danger btn-sm ml-auto",attrs:{type:"button"},on:{click:function(a){return t.addtoCart(s.id,t.productQty=1)}}},[t.status.loadingItem===s.id?a("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("\r\n                      加到購物車\r\n                    ")])])])])}),0),t._v(" "),a("div",{staticClass:"my-5 row justify-content-center"},[a("div",{staticClass:"my-5 col-7 mx-auto justify-content-center"},[a("table",{staticClass:"table"},[t._m(0),t._v(" "),a("tbody",[a("tr",[0===t.cart.carts.length?a("td",{staticClass:"h4 text-topic py-6 text-center",attrs:{colspan:"4"}},[t._v("購物車尚無商品，歡迎繼續選購~")]):t._e()]),t._v(" "),t._l(t.cart.carts,function(s){return t.cart.carts?a("tr",{key:s.id},[a("td",{staticClass:"align-middle py-4"},[a("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button"},on:{click:function(a){return t.delCart(s.id)}}},[a("i",{staticClass:"far fa-trash-alt"})])]),t._v(" "),a("td",{staticClass:"align-middle"},[t._v("\r\n                          "+t._s(s.product.title)+"\r\n                          "),s.coupon?a("div",{staticClass:"text-success"},[t._v("\r\n                              已套用優惠券\r\n                          ")]):t._e()]),t._v(" "),a("td",{staticClass:"align-middle"},[t._v(t._s(s.qty)+" "+t._s(s.product.unit))]),t._v(" "),a("td",{staticClass:"align-middle text-right"},[t._v(t._s(s.final_total))])]):t._e()})],2),t._v(" "),t.cart.carts.length>0?a("tfoot",[a("tr",[a("td",{staticClass:"text-right py-4",attrs:{colspan:"3"}},[t._v("總計")]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t.cart.total))])]),t._v(" "),t.cart.final_total!=t.cart.total?a("tr",[a("td",{staticClass:"text-right text-success py-4 font-weight-bolder",attrs:{colspan:"3"}},[t._v("折扣價")]),t._v(" "),a("td",{staticClass:"text-right text-success"},[t._v(t._s(t.cart.final_total))])]):t._e()]):t._e()]),t._v(" "),a("div",{staticClass:"input-group mt-5 mb-9 input-group-sm"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],staticClass:"form-control",staticStyle:{height:"46.8px"},attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.coupon_code},on:{input:function(s){s.target.composing||(t.coupon_code=s.target.value)}}}),t._v(" "),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-outline-secondary py-4",attrs:{type:"button"},on:{click:t.addCouponCode}},[t._v("\r\n                      套用優惠碼\r\n                  ")])])]),t._v(" "),a("Validation-observer",{scopedSlots:t._u([{key:"default",fn:function(s){var e=s.invalid;return[a("form",{staticClass:"px-0",on:{submit:function(s){return s.preventDefault(),t.createOrder(s)}}},[a("validation-provider",{attrs:{rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(s){var e=s.errors,o=s.classes;return[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"email"}},[t._v("Email")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control",class:o,attrs:{name:"Email",type:"email",id:"email",placeholder:"請輸入Email"},domProps:{value:t.form.user.email},on:{input:function(s){s.target.composing||t.$set(t.form.user,"email",s.target.value)}}}),t._v(" "),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(e[0]))])])]}}],null,!0)}),t._v(" "),a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var e=s.errors,o=s.classes;return[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"name"}},[t._v("收件人姓名")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control",class:o,attrs:{name:"收件人姓名",type:"text",id:"name",placeholder:"請輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(s){s.target.composing||t.$set(t.form.user,"name",s.target.value)}}}),t._v(" "),a("span",{staticClass:"text-danger"},[t._v(t._s(e[0]))])])]}}],null,!0)}),t._v(" "),a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var e=s.errors,o=s.classes;return[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"telphone"}},[t._v("收件人電話")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control",class:o,attrs:{name:"電話",type:"tel",id:"telphone",placeholder:"請輸入電話"},domProps:{value:t.form.user.tel},on:{input:function(s){s.target.composing||t.$set(t.form.user,"tel",s.target.value)}}}),t._v(" "),a("span",{staticClass:"text-danger"},[t._v(t._s(e[0]))])])]}}],null,!0)}),t._v(" "),a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var e=s.errors,o=s.classes;return[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"address"}},[t._v("收件人地址")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control",class:o,attrs:{name:"收件人地址",type:"address",id:"address",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(s){s.target.composing||t.$set(t.form.user,"address",s.target.value)}}}),t._v(" "),a("span",{staticClass:"text-danger"},[t._v(t._s(e[0]))])])]}}],null,!0)}),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"useraddress"}},[t._v("留言")]),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.form.message},on:{input:function(s){s.target.composing||t.$set(t.form,"message",s.target.value)}}})]),t._v(" "),a("div",{staticClass:"text-right"},[a("button",{staticClass:"btn btn-danger",attrs:{disabled:e}},[t._v("送出訂單")])])],1)]}}])})],1)])]),t._v(" "),a("div",{staticClass:"modal fade",attrs:{id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v(t._s(t.product.title))]),t._v(" "),t._m(1)]),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"d-flex justify-content-center"},[a("img",{staticClass:"img-fluid",staticStyle:{height:"250px","background-size":"cover","background-position":"center"},attrs:{src:t.product.imageUrl,alt:""}})]),t._v(" "),a("blockquote",{staticClass:"blockquote mt-3"},[a("p",{staticClass:"mb-0"},[t._v(t._s(t.product.content))]),t._v(" "),a("footer",{staticClass:"blockquote-footer text-left"},[t._v(t._s(t.product.description))])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-between align-items-baseline"},[t.product.price?t._e():a("div",{staticClass:"h4"},[t._v(t._s(t.product.origin_price)+" 元")]),t._v(" "),t.product.price?a("del",{staticClass:"h6"},[t._v("原價 "+t._s(t.product.origin_price)+" 元")]):t._e(),t._v(" "),t.product.price?a("div",{staticClass:"h4"},[t._v("現在只要 "+t._s(t.product.price)+" 元")]):t._e()]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.productQty,expression:"productQty"}],staticClass:"form-control mt-3",attrs:{name:""},on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.productQty=s.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"0",disabled:"",selected:""}},[t._v("請選擇數量")]),t._v(" "),t._l(10,function(s){return a("option",{key:s,domProps:{value:s}},[t._v("\r\n                選購 "+t._s(s)+" "+t._s(t.product.unit)+"\r\n              ")])})],2)]),t._v(" "),a("div",{staticClass:"modal-footer"},[t.product.price?a("div",{staticClass:"text-muted text-nowrap mr-3"},[t._v("\r\n              小計 "),a("strong",[t._v(t._s(t.productQty*t.product.price))]),t._v(" 元\r\n            ")]):t._e(),t._v(" "),a("button",{staticClass:"btn btn-warning",attrs:{type:"button",disabled:0===t.productQty},on:{click:function(s){return t.addtoCart(t.product.id,t.productQty)}}},[t.product.id===t.status.loadingItem?a("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("\r\n              加到購物車\r\n            ")])])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("thead",[s("th",{attrs:{width:"80"}}),this._v(" "),s("th",{staticClass:"py-4",attrs:{width:"200"}},[this._v("品名")]),this._v(" "),s("th",{staticClass:"py-4",attrs:{width:"100"}},[this._v("數量")]),this._v(" "),s("th",{staticClass:"py-4",attrs:{width:"50"}},[this._v("單價")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[s("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])}]};var r=a("VU/8")(e,o,!1,function(t){a("P3ON")},"data-v-ae81ef44",null);s.default=r.exports},P3ON:function(t,s){}});
//# sourceMappingURL=4.8b01c7354d3d8cceebb4.js.map